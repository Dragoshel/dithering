(()=>{"use strict";var e;!function(e){e[e.NEAREST=0]="NEAREST",e[e.FLOYD_STEINBERG=1]="FLOYD_STEINBERG"}(e||(e={}));var t=function(){function t(){var e=this;this._offscreenCanvas=document.getElementById("offscreenCanvas"),this._offscreenContext=this._offscreenCanvas.getContext("2d"),this._renderingImage=document.getElementById("renderingImage"),this.scale=1,this.isDragging=!1,this.offsetX=0,this.offsetY=0,this._renderingImage.addEventListener("wheel",(function(t){e.scale+=t.deltaY/1e3,e._renderingImage.style.scale=e.scale.toString()})),this._renderingImage.addEventListener("dragstart",(function(t){e.isDragging=!0,e._renderingImage.addEventListener("mousemove",(function(t){return e.isDragging&&(e._renderingImage.style.transform="translate(".concat(t.offsetX/10,"px, ").concat(t.offsetY/10,"px)")),!1}))})),this._renderingImage.addEventListener("dragend",(function(t){e.isDragging=!1}))}return Object.defineProperty(t.prototype,"width",{get:function(){return this._offscreenCanvas.width},set:function(e){this._offscreenCanvas.width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._offscreenCanvas.height},set:function(e){this._offscreenCanvas.height=e},enumerable:!1,configurable:!0}),t.prototype.dither=function(t,n,r){this._offscreenContext.drawImage(t,0,0);var i=this._offscreenContext.getImageData(0,0,this.width,this.height),s=null==i?void 0:i.data;if(n.colors.length>0)switch(r){case e.NEAREST:this.ditherNearest(s,n);break;case e.FLOYD_STEINBERG:this.ditherFloydSteinberg(s,n,this.width,this.height)}this._offscreenContext.putImageData(i,0,0),this._renderingImage.src=this._offscreenCanvas.toDataURL()},t.prototype.ditherNearest=function(e,t){for(var n=0;n<e.length;n+=4){var r={r:e[n],g:e[n+1],b:e[n+2]},i=t.findNearestColor(r);e[n]=i.r,e[n+1]=i.g,e[n+2]=i.b}},t.prototype.ditherFloydSteinberg=function(e,t,n,r){for(var i=0;i<e.length;i+=4){var s={r:e[i],g:e[i+1],b:e[i+2]},a=t.findNearestColor(s),o={r:s.r-a.r,g:s.g-a.g,b:s.b-a.b};e[i]=a.r,e[i+1]=a.g,e[i+2]=a.b,e[i+4]+=7*o.r/16,e[i+4+1]+=7*o.g/16,e[i+4+2]+=7*o.b/16,e[i+4*(n-1)]+=3*o.r/16,e[i+4*(n-1)+1]+=3*o.g/16,e[i+4*(n-1)+2]+=3*o.b/16,e[i+4*n]+=5*o.r/16,e[i+4*n+1]+=5*o.g/16,e[i+4*n+2]+=5*o.b/16,e[i+4*(n+1)]+=1*o.r/16,e[i+4*(n+1)+1]+=1*o.g/16,e[i+4*(n+1)+2]+=1*o.b/16}},t}();const n=t,r=function(){function e(){var e=this;this.colors=[];var t=document.getElementById("display"),n=document.getElementById("picker");n.addEventListener("change",(function(){var r=document.createElement("div");r.setAttribute("style","background-color: ".concat(n.value)),t.append(r);var i,s=(3===(i=(i=n.value).replace("#","")).length&&(i=i.split("").map((function(e){return e+e})).join("")),{r:parseInt(i.slice(0,2),16),g:parseInt(i.slice(2,4),16),b:parseInt(i.slice(4,6),16)});e.colors.push(s)}))}return e.prototype.findNearestColor=function(e){for(var t=99999,n=0,r=e.r,i=e.g,s=e.b,a=0;a<this.colors.length;a++){var o=this.colors[a].r,c=this.colors[a].g,g=this.colors[a].b,d=Math.floor(Math.sqrt((o-r)*(o-r)+(c-i)*(c-i)+(g-s)*(g-s)));t>d&&(t=d,n=a)}return this.colors[n]},e}();var i=new n,s=new r,a=document.getElementById("input"),o=document.getElementById("select");document.getElementById("form").addEventListener("submit",(function(e){if(e.preventDefault(),a.files.length>0){var t=(n=a.files[0],r=new Image,(c=new FileReader).addEventListener("load",(function(){r.src=c.result})),c.readAsDataURL(n),r);t.addEventListener("load",(function(){i.width=t.width,i.height=t.height,i.dither(t,s,o.selectedIndex)}))}var n,r,c}))})();